{
 "cells": [
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## $\\underline{\\textbf{SQL Notes}}$"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h1 align=\"center\">Queries</h1> \n",
    "statement declaring what data to look for, where in database, and optionally how to transform it before it's returned.\n",
    "\n",
    "$\\underline{\\text{simple select query for specific columns}}:$  \n",
    "``` sql\n",
    "SELECT column_name, another_column, …\n",
    "FROM mytable;\n",
    "```\n",
    "#can use asteric (*) to indicate all.\n",
    "\n",
    "$\\underline{\\text{select query w/ constraint}}:$\n",
    "``` sql\n",
    "SELECT column_name, another_column, …\n",
    "FROM mytable\n",
    "WHERE condition\n",
    "    AND/OR another_condition\n",
    "    AND/OR ..;\n",
    "```\n",
    "might find these operators useful: \n",
    "\n",
    "<div class=\"datatable\">\n",
    "    <table class=\"table table-striped table-condensed\">\n",
    "        <tbody><tr>\n",
    "            <td style=\"width: 20%; text-align: center;\">Operator</td>\n",
    "            <td style=\"width: 50%\">Condition</td>\n",
    "            <td>SQL Example</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">=, !=, &lt; &lt;=, &gt;, &gt;=</td>\n",
    "            <td>Standard numerical operators</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">!=</span> 4</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">BETWEEN … AND …</td>\n",
    "            <td>Number is within range of two values (inclusive)</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">BETWEEN</span> 1.5 <span class=\"faux-keyword\">AND</span> 10.5</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">NOT BETWEEN … AND …</td>\n",
    "            <td>Number is not within range of two values (inclusive)</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">NOT BETWEEN</span> 1 <span class=\"faux-keyword\">AND</span> 10</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">IN (…)</td>\n",
    "            <td>Number exists in a list</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">IN</span> (2, 4, 6)</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">NOT IN (…)</td>\n",
    "            <td>Number does not exist in a list</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">NOT IN</span> (1, 3, 5)</td>\n",
    "        </tr>\n",
    "    </tbody></table>\n",
    "</div>\n",
    "\n",
    "expanded operator table:\n",
    "<div class=\"datatable\">\n",
    "    <table class=\"table table-striped table-condensed\">\n",
    "        <tbody><tr>\n",
    "            <td style=\"width: 15%; text-align: center;\">Operator</td>\n",
    "            <td style=\"width: 60%\">Condition</td>\n",
    "            <td>Example</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">=</td>\n",
    "            <td>Case sensitive exact string comparison (<em>notice the single equals</em>)</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">=</span> \"abc\"</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">!= or &lt;&gt;</td>\n",
    "            <td>Case sensitive exact string inequality comparison</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">!=</span> \"abcd\"</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">LIKE</td>\n",
    "            <td>Case insensitive exact string comparison</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">LIKE</span> \"ABC\"</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">NOT LIKE</td>\n",
    "            <td>Case insensitive exact string inequality comparison</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">NOT LIKE</span> \"ABCD\"</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">%</td>\n",
    "            <td>Used anywhere in a string to match \n",
    "                a sequence of zero or more characters (only with LIKE or NOT LIKE)</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">LIKE</span> \"%AT%\"<br>\n",
    "                (matches \"<span class=\"uline\">AT</span>\", \"<span class=\"uline\">AT</span>TIC\", \"C<span class=\"uline\">AT</span>\" \n",
    "                    or even \"B<span class=\"uline\">AT</span>S\")</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">_</td>\n",
    "            <td>Used anywhere in a string to match \n",
    "                a single character (only with LIKE or NOT LIKE)</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">LIKE</span> \"AN_\"<br>\n",
    "                (matches \"<span class=\"uline\">AN</span>D\", but not \"<span class=\"uline\">AN</span>\")</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">IN (…)</td>\n",
    "            <td>String exists in a list</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">IN</span> (\"A\", \"B\", \"C\")</td>\n",
    "        </tr>\n",
    "        <tr>\n",
    "            <td style=\"text-align: center;\">NOT IN (…)</td>\n",
    "            <td>String does not exist in a list</td>\n",
    "            <td>col_name <span class=\"faux-keyword\">NOT IN</span> (\"D\", \"E\", \"F\")</td>\n",
    "        </tr>\n",
    "    </tbody></table>\n",
    "</div>\n",
    "\n",
    "notes that full-text search is better left to deticated libraries like $\\textbf{Apache Lucene}$ or $\\textbf{Sphinx}$.\n",
    "\n",
    "$\\textbf{Ex}.$ to find all Toy Story movies:\n",
    "``` sql\n",
    "SELECT *\n",
    "FROM movies\n",
    "WHERE Title LIKE \"%Toy Story%\";\n",
    "```"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h1 align=\"center\">Filtering</h1> \n",
    "\n",
    "$\\textbf{DISTINCT}:$ keyword that'll blindly discard duplicated values when querrying\n",
    "``` sql\n",
    "SELECT DISTINCT column1, column2, ...\n",
    "FROM mytable\n",
    "WHERE conditions;\n",
    "```\n",
    "Since the $\\text{DISTINCT}$ keyword will blindly remove duplicate rows, we will learn in a future lesson how to discard duplicates based on specific columns using grouping and the $\\text{GROUP BY}$ clause.\n",
    "\n",
    "$\\textbf{ORDER BY}:$ clause to sort results by a given column in ASCending or DESCending order.\n",
    "``` sql\n",
    "SELECT column1, column2, ...\n",
    "FROM mytable\n",
    "WHERE conditions\n",
    "ORDER BY column1 ASC/DESC;\n",
    "```\n",
    "each row is sorted alpha-numerically based on the specified column's values, in some databases you can also specify a collation to better soty data containing multi-language text.\n",
    "\n",
    "$\\textbf{LIMIT and OFFSET}:$ clauses commonly used with $\\text{ORDER BY}$. the $\\text{LIMIT}$ will reduce the number of rows to return, and the optional $\\text{OFFSET}$ will specify where to begin counting the number rows from.\n",
    "``` sql\n",
    "SELECT column1, column2, ...\n",
    "FROM mytable\n",
    "WHERE conditions\n",
    "ORDER BY column1 ASC/DESC\n",
    "LIMIT num_limit OFFSET num_offset;\n",
    "```\n",
    "\n",
    "$\\textbf{Ex.}$ to list pixar movies sorted alphabetically offseted by 5:\n",
    "``` sql\n",
    "SELECT title FROM movies\n",
    "ORDER BY title ASC\n",
    "LIMIT 5 OFFSET 5;\n",
    "```"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h1 align=\"center\">Database Normalization</h1>  \n",
    "\n",
    "going from single table -> multiple orthogonal tables, using normalization.\n",
    "\n",
    "main purpose: removing duplicate entries while allowing the different tables to change independent of eachother. \n",
    "\n",
    "queries get more complex since they have to find data from different parts of the databases. there are thus also performence issues.\n",
    "\n",
    "\n",
    "$\\textbf{JOINs}:$  \n",
    "tables that share info about a single entity need to have a $\\it{primary \\space key}$ that identifies that entity $\\it{uniquely}$ across the database.\n",
    "\n",
    "common primary key type is an auto-incrementing integer (space efficient), but it can be any unique key, such as string, hashed value, etc.\n",
    "\n",
    "the $\\text{JOIN}$ clause in a query can combine row data across two seperate tables using a unique key.\n",
    "\n",
    "$\\textbf{INNER JOIN}:$  \n",
    "a process that matches rows from the first table and the second which have the same key (as defined by the $\\text{ON}$ constraint). \n",
    "\n",
    "``` sql\n",
    "SELECT column1, column2, ...\n",
    "FROM mytable\n",
    "INNER JOIN table2\n",
    "    ON mytable.id = table2.id\n",
    "WHERE conditions\n",
    "ORDER BY column, ... ASC/DESC\n",
    "LIMIT num_limit OFFSET num_offest;\n",
    "```\n",
    "\n",
    "this results in a row with combined columns from both tables. after the tables are joined, the other clauses are applied.\n",
    "\n",
    "NOTE: $\\text{INNER JOIN}$ can be written as $\\text{JOIN}$, however we use the first to dinstinguish from other types of joins. \n",
    "\n",
    "$\\textbf{Ex.}$ two tables, \"Movies\" and \"Boxoffice\" that are to be joined, want to show movies where int sales greater than domestic, ordered by rating desc:\n",
    "\n",
    "``` sql\n",
    "SELECT * FROM Movies\n",
    "INNER JOIN Boxoffice\n",
    "    ON Movies.Id = Boxoffice.Movie_id\n",
    "WHERE International_sales > Domestic_sales\n",
    "ORDER BY Rating DESC;\n",
    "```\n",
    "\n",
    "$\\textbf{OUTER JOIN}:$"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.10.4 64-bit",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.10.4"
  },
  "orig_nbformat": 4,
  "vscode": {
   "interpreter": {
    "hash": "4b926fbef4f16296dee587ec63e8d7863a1bca5b92838282751c68743259275e"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
